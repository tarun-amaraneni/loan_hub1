{% extends 'base.html' %}
{% load static %}

{% block content %}

<style>
    .upload-box{
        width: 60%;
        margin:50px auto;
        background:#fff;
        padding:30px;
        border-radius:8px;
        box-shadow:0 4px 15px rgba(0,0,0,0.07);
        text-align:center;
    }
    .upload-box h2{
        color:#34495e;
        margin-bottom:25px;
        font-size:28px;
        font-weight:600;
    }
    .file-input{
        background:#f8f9fa;
        padding:10px;
        border:1px solid #dcdcdc;
        border-radius:5px;
    }
    .upload-btn{
        background:#2ecc71;
        color:white;
        border:none;
        padding:10px 22px;
        margin-left:10px;
        font-size:16px;
        border-radius:5px;
        cursor:pointer;
        transition:0.3s;
    }
    .upload-btn:hover{
        background:#27ae60;
    }

    /* Table Style */
    table{
        width:70%;
        margin:20px auto;
        border-collapse:collapse;
        font-size:16px;
    }
    table th, table td{
        border:1px solid #ccc;
        padding:10px;
        text-align:center;
    }
    table th{
        background:#34495e;
        color:white;
    }
    table tr:nth-child(even){
        background:#f7f9fb;
    }

    /* Download Link Button */
    .download-link{
        background:#3498db;
        color:white;
        padding:10px 20px;
        border-radius:6px;
        font-size:18px;
        display:inline-block;
        text-decoration:none;
        transition:.3s;
    }
    .download-link:hover{
        background:#1d79bb;
    }

    /* Error styles */
    .error-box{
        width:60%;
        margin:20px auto;
        background:#ffe6e6;
        padding:15px;
        border-left:5px solid red;
        color:#c0392b;
        border-radius:5px;
    }
</style>


<div class="upload-box">
    <h2>ðŸ“¤ Upload Bulk Excel</h2>

    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="file" class="file-input" name="excel_file" accept=".xlsx" required>
        <button type="submit" class="upload-btn">Upload</button>
    </form>
</div>


{% if inserted %}


    <!-- <table>
        <tr><th>Sheet</th><th>Inserted</th><th>Updated</th></tr>
        <tr><td>Users</td><td>{{ inserted.Users }}</td><td>{{ updated.Users }}</td></tr>
        <tr><td>CashEntry</td><td>{{ inserted.CashEntry }}</td><td>{{ updated.CashEntry }}</td></tr>
        <tr><td>Loans</td><td>{{ inserted.Loans }}</td><td>{{ updated.Loans }}</td></tr>
        <tr><td>Deposits</td><td>{{ inserted.Deposits }}</td><td>{{ updated.Deposits }}</td></tr>
        <tr><td>Others</td><td>{{ inserted.Others }}</td><td>{{ updated.Others }}</td></tr>
    </table>

    {% if errors %}
        <div class="error-box">
            <h4 style="margin-top:0;">âš  Errors Found:</h4>
            <ul>
                {% for e in errors %}
                    <li>{{ e }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %} -->
{% endif %}



<div style="text-align:center;margin-top:25px;margin-bottom:60px;">
    <a href="{% url 'download_sample_excel' %}" download
       style="background:#4CAF50;color:white;padding:12px 22px;border-radius:6px;
       text-decoration:none;font-size:17px;font-weight:600;transition:.3s;">
        â¬‡ Download Sample Excel
    </a>
</div>

{% endblock %}


